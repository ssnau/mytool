<!doctype html><html> <head> <meta charset="utf-8"> <meta other="__ver: 1667491438683"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width"> <style>#container,body,html{width:100%;height:100%}</style> <title>POLYGON TEST</title> <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"> </head> <body> <div id="container"></div> <div class="nav-card" style="width:120px;position:fixed;top:10px;left:10px;width:200px;"> <input id="searchCity" onkeyup="handlekeyup(event)" placeholder="输入城市或POI名"> <button class="btn" style="background:#fff" onclick="search()"> GOTO </button> </div> <div class="input-card" style="width:120px"> <button class="btn" onclick="restart()" style="margin-bottom:5px">初始化多边形</button> <button class="btn" onclick="polyEditor.open()" style="margin-bottom:5px;display:none">开始编辑</button> <button class="btn" onclick="polyEditor.close();" style="display:none;">结束编辑</button> </div> <div style="position:fixed;bottom:20px;left:10px;"> <textarea style="width:200px;height:60px;font-size:9px;" id="polygondata"></textarea> </div>  <script>function t(t,a){return o(t)||n(t,a)||e()}function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function n(t,e){var n=[],o=!0,a=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(u){a=!0,r=u}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return n}function o(t){if(Array.isArray(t))return t}var a=new Proxy(new URLSearchParams(window.location.search),{get:function(t,e){return t.get(e)}});function r(t,e){var n=100,o=0,a=Date.now();return new Promise(function(e){!function r(){return o&&Date.now()-a>o?e(!1):t()?e(t()):void setTimeout(r,n)}()})}function i(t){var e=document.createElement("script");e.setAttribute("src",t),document.head.appendChild(e)}function c(t){document.write(" <script "+'type="text/javascript"\n  src="'.concat(t,'"> </')+"script>")}if(a.gaodejskey)c("https://webapi.amap.com/maps?v=1.4.15&key=".concat(a.gaodejskey,"&plugin=AMap.PolyEditor,AMap.PlaceSearch")),r(function(){return"undefined"!=typeof AMap}).then(function(){return i("https://cache.amap.com/lbs/static/PlaceSearchRender.js")}),r(function(){return"undefined"!=typeof AMap}).then(function(){return i("https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js")});else{var u=location.origin+location.pathname;document.body.innerHTML="gaodejskey is empty, please define it on querystring by visiting ".concat(u,"?gaodejskey=xxxx")}if(!a.gaodejskey)throw new Error("no gaodejskey founded");r(function(){return"undefined"!=typeof AMap&&AMap.Map&&AMap.Polygon&&AMap.PolyEditor&&AMap.PlaceSearch}).then(function(){var e=new AMap.Map("container",{center:[116.399245,39.917267],zoom:14}),n=new AMap.Polygon({path:[[116.403322,39.920255],[116.410703,39.897555],[116.402292,39.892353],[116.389846,39.891365]],strokeColor:"#FF33FF",strokeWeight:6,strokeOpacity:.2,fillOpacity:.4,fillColor:"#1791fc",zIndex:50});window.polygon=n,window.map=e,e.add(n),e.setFitView([n]);var o=new AMap.PolyEditor(e,n);function a(){var t=e.getCenter(),o=t.lat,a=t.lng;document.getElementById("polygondata").value="POLYGON:"+n.getPath().map(function(t){return t.lng+","+t.lat}).join(";")+"@"+a+","+o}o.on("end",function(t){log.info("触发事件： end"),console.log(t.target)}),o.on("adjust",function(){setTimeout(a,100)}),setTimeout(function(){restart(),a(),o.open()},100),window.search=function(){var n=t(document.getElementById("searchCity").value.trim().split(/\s+/),2),o=n[0],a=n[1];console.log({city:o,poi:a}),new AMap.PlaceSearch({city:o}).search(a||o,function(t,n){var o=n.poiList&&n.poiList.count?n.poiList.pois[0]:null;if(!o)return alert("找不找你要的地方，写详细点");e.setCenter([o.location.lng,o.location.lat])})},window.handlekeyup=function(t){if(13===t.keyCode)return search()},window.restart=function(){var t=e.getCenter(),o=t.lat,a=t.lng;n.setPath([[a-.01,o-.01],[a+.01,o-.01],[a+.01,o+.01],[a-.01,o+.01]])}});</script> </body> </html>