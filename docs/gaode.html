<!doctype html><html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width"> <style>#container,body,html{width:100%;height:100%}</style> <title>POLYGON TEST</title> <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"> </head> <body> <div id="container"></div> <div class="nav-card" style="width:120px;position:fixed;top:10px;left:10px;width:200px;"> <input id="searchCity" onkeyup="handlekeyup(event)" placeholder="输入城市或POI名"> <button class="btn" style="background:#fff" onclick="search()"> GOTO </button> </div> <div class="input-card" style="width:120px"> <button class="btn" onclick="restart()" style="margin-bottom:5px">初始化多边形</button> <button class="btn" onclick="polyEditor.open()" style="margin-bottom:5px;display:none">开始编辑</button> <button class="btn" onclick="polyEditor.close();" style="display:none;">结束编辑</button> </div> <div style="position:fixed;bottom:20px;left:10px;"> <textarea style="width:200px;height:60px;font-size:9px;" id="polygondata"></textarea> </div>  <script>function t(t,a){return o(t)||n(t,a)||e()}function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function n(t,e){var n=[],o=!0,a=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(l){a=!0,r=l}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return n}function o(t){if(Array.isArray(t))return t}var a=new Proxy(new URLSearchParams(window.location.search),{get:function(t,e){return t.get(e)}});function r(t){document.write(" <script "+'type="text/javascript"\n  src="'.concat(t,'"> </')+"script>")}if(a.gaodejskey)r("https://webapi.amap.com/maps?v=1.4.15&key=".concat(a.gaodejskey,"&plugin=AMap.PolyEditor,AMap.PlaceSearch")),r("https://cache.amap.com/lbs/static/PlaceSearchRender.js"),r("https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js");else{var i=location.origin+location.pathname;document.body.innerHTML="gaodejskey is empty, please define it on querystring by visiting ".concat(i,"?gaodejskey=xxxx")}if(!a.gaodejskey)throw new Error("no gaodejskey founded");var c=new AMap.Map("container",{center:[116.399245,39.917267],zoom:14}),l=[[116.403322,39.920255],[116.410703,39.897555],[116.402292,39.892353],[116.389846,39.891365]],s=new AMap.Polygon({path:l,strokeColor:"#FF33FF",strokeWeight:6,strokeOpacity:.2,fillOpacity:.4,fillColor:"#1791fc",zIndex:50});window.polygon=s,window.map=c,c.add(s),c.setFitView([s]);var u=new AMap.PolyEditor(c,s);function p(){var t=c.getCenter(),e=t.lat,n=t.lng;document.getElementById("polygondata").value="POLYGON:"+s.getPath().map(function(t){return t.lng+","+t.lat}).join(";")+"@"+n+","+e}u.on("end",function(t){log.info("触发事件： end"),console.log(t.target)}),u.on("adjust",function(){setTimeout(p,100)}),setTimeout(function(){restart(),p(),u.open()},100),window.search=function(){var e=t(document.getElementById("searchCity").value.trim().split(/\s+/),2),n=e[0],o=e[1];console.log({city:n,poi:o}),new AMap.PlaceSearch({city:n}).search(o||n,function(t,e){var n=e.poiList&&e.poiList.count?e.poiList.pois[0]:null;if(!n)return alert("找不找你要的地方，写详细点");c.setCenter([n.location.lng,n.location.lat])})},window.handlekeyup=function(t){if(13===t.keyCode)return search()},window.restart=function(){var t=c.getCenter(),e=t.lat,n=t.lng;s.setPath([[n-.01,e-.01],[n+.01,e-.01],[n+.01,e+.01],[n-.01,e+.01]])};</script> </body> </html>