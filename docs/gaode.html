<!doctype html><html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width"> <style>#container,body,html{width:100%;height:100%}</style> <title>POLYGON TEST</title> <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"> <script src="https://webapi.amap.com/maps?v=1.4.15&key=8dc0e082257bfba1367acb9fbc014f62&plugin=AMap.PolyEditor,AMap.PlaceSearch"></script> <script type="text/javascript" src="https://cache.amap.com/lbs/static/PlaceSearchRender.js"></script> <script src="https://a.amap.com/jsapi_demos/static/demo-center/js/demoutils.js"></script> </head> <body> <div id="container"></div> <div class="nav-card" style="width:120px;position:fixed;top:10px;left:10px;width:200px;"> <input id="searchCity" onkeyup="handlekeyup(event)" placeholder="输入城市或POI名"> <button class="btn" style="background:#fff" onclick="search()"> GOTO </button> </div> <div class="input-card" style="width:120px"> <button class="btn" onclick="restart()" style="margin-bottom:5px">初始化多边形</button> <button class="btn" onclick="polyEditor.open()" style="margin-bottom:5px;display:none">开始编辑</button> <button class="btn" onclick="polyEditor.close();" style="display:none;">结束编辑</button> </div> <div style="position:fixed;bottom:20px;left:10px;"> <textarea style="width:200px;height:60px;font-size:9px;" id="polygondata"></textarea> </div> <script>function t(t,r){return o(t)||e(t,r)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function e(t,n){var e=[],o=!0,r=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(o=(a=l.next()).done)&&(e.push(a.value),!n||e.length!==n);o=!0);}catch(c){r=!0,i=c}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return e}function o(t){if(Array.isArray(t))return t}var r=new AMap.Map("container",{center:[116.399245,39.917267],zoom:14}),i=[[116.403322,39.920255],[116.410703,39.897555],[116.402292,39.892353],[116.389846,39.891365]],a=new AMap.Polygon({path:i,strokeColor:"#FF33FF",strokeWeight:6,strokeOpacity:.2,fillOpacity:.4,fillColor:"#1791fc",zIndex:50});window.polygon=a,window.map=r,r.add(a),r.setFitView([a]);var l=new AMap.PolyEditor(r,a);function c(){var t=r.getCenter(),n=t.lat,e=t.lng;document.getElementById("polygondata").value="POLYGON:"+a.getPath().map(function(t){return t.lng+","+t.lat}).join(";")+"@"+e+","+n}l.on("end",function(t){log.info("触发事件： end"),console.log(t.target)}),l.on("adjust",function(){setTimeout(c,100)}),setTimeout(function(){restart(),c(),l.open()},100),window.search=function(){var n=t(document.getElementById("searchCity").value.trim().split(/\s+/),2),e=n[0],o=n[1];console.log({city:e,poi:o}),new AMap.PlaceSearch({city:e}).search(o||e,function(t,n){var e=n.poiList&&n.poiList.count?n.poiList.pois[0]:null;if(!e)return alert("找不找你要的地方，写详细点");r.setCenter([e.location.lng,e.location.lat])})},window.handlekeyup=function(t){if(13===t.keyCode)return search()},window.restart=function(){var t=r.getCenter(),n=t.lat,e=t.lng;a.setPath([[e-.01,n-.01],[e+.01,n-.01],[e+.01,n+.01],[e-.01,n+.01]])};</script> </body> </html>