<!DOCTYPE html><html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta http-equiv="X-UA-Compatible" content="ie=edge"> <title>DITU MARK</title> <link href="http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext" rel="stylesheet" type="text/css"> <link rel="stylesheet" href="mini-default.min.1469ec79.css"> <style>#container,body,html{height:100%;width:100%}.amap-icon img,.amap-marker-content img{width:25px;height:34px}.marker{position:absolute;top:-20px;right:-118px;color:#fff;padding:4px 10px;box-shadow:1px 1px 1px rgba(10,10,10,.2);white-space:nowrap;font-size:12px;background-color:#25a5f7;border-radius:3px}</style> </head> <body> <div id="container"></div> <label for="modal-control" style="position:fixed;top:100px;right:100px;z-index:999;background-color:bisque;">显示配置</label> <input type="checkbox" id="modal-control" class="modal"> <div> <div class="card" style="max-width:780px;"> <label for="modal-control" class="modal-close"></label> <h3 class="section">配置</h3> <div class="row" id="navContainer"> <button class="small nav-btn" data-to="dCenter" id="nav-default">设置中心</button> <button class="small nav-btn" data-to="dMark">标记POI</button> <button class="small nav-btn" data-to="dSearch">搜索POI</button> </div> <div id="dCenter" class="nav-content"> <legend>地图中心</legend> <input type="text" class="center-input" id="centerLng" placeholder="纬度" value="116.397428"> <input type="text" class="center-input" id="centerLat" placeholder="经度" value="39.90923 "> <button class="primary" onclick="setCenter()">确定</button> <legend>快捷方式</legend> <button onclick="setCenter(116.397029,39.91784)">北京</button> <button onclick="setCenter(121.499718, 31.239703)">上海</button> <button onclick="setCenter(120.164704, 30.25221)">杭州</button> <button onclick="setCenter(104.078657, 30.654899)">成都</button> <button onclick="setCenter(113.324553, 23.106414)">广州</button> <button onclick="setCenter(114.059812, 22.530799)">深圳</button> </div> <div id="dMark" class="nav-content"> <legend>要标记的POI列表</legend> <textarea placeholder="名字,经度,纬度" id="pois" style="width:96%"></textarea> <button class="primary" onclick="markIt()">确定标记</button> </div> <div id="dSearch" class="nav-content"> <legend>输入城市和POI名</legend> <input type="text" class="search-input" id="searchCity" value="杭州"> <input type="text" class="search-input" id="searchPOI" value="西湖国际中心"> <button class="primary" onclick="search()">搜索</button> <br> <pre id="searchResult"></pre> <p style="padding:6px 0;">tip: 可以用 window.apiSearch(city, poiName) 来脚本化。 <img src="https://d2q5pvpg2i44d2.cloudfront.net/resources/20228/a28-4287-9b85-d9560b297385.png"></p> </div> </div> </div>   <script>function e(){Array.from(document.querySelectorAll(".nav-content")).forEach(function(e){return e.style.display="none"}),Array.from(document.querySelectorAll(".nav-btn")).forEach(function(e){return e.className=e.className.replace("inverse"," ").trim()})}function n(n){var t=n.dataset.to;t&&(e(),document.getElementById(t).style.display="block",n.className+=" inverse ")}function t(e,n){c.setCenter([e||document.getElementById("centerLng").value-0,n||document.getElementById("centerLat").value-0])}function o(){var e=new AMap.PlaceSearch({city:document.getElementById("searchCity").value}),n=document.getElementById("searchResult");n.innerHTML=" loading...",e.search(document.getElementById("searchPOI").value,function(e,t){console.log(t);var o=t.poiList.count?t.poiList.pois[0]:{};n.innerHTML="\n        ".concat(o.address,", ").concat(o.location.lng,", ").concat(o.location.lat," \n        ").trim()})}e(),n(document.getElementById("nav-default")),document.getElementById("navContainer").addEventListener("click",function(e){n(e.target)}),window.setCenter=t,window.search=o,window.apiSearch=function(e,n){return new Promise(function(t){new AMap.PlaceSearch({city:e}).search(n,function(e,n){t(n.poiList.count?n.poiList.pois[0]:null)})})};var a=new Proxy(new URLSearchParams(window.location.search),{get:function(e,n){return e.get(n)}});function r(e){document.write(" <script "+'type="text/javascript" src="'.concat(e,'"> </')+"script>")}if(a.gaodejskey)r("https://webapi.amap.com/maps?v=1.4.15&key=".concat(a.gaodejskey,"&plugin=AMap.PlaceSearch")),r("https://cache.amap.com/lbs/static/PlaceSearchRender.js");else{var i=location.origin+location.pathname;document.body.innerHTML="gaodejskey is empty, please define it on querystring by visiting ".concat(i,"?gaodejskey=xxxx")}if(!a.gaodejskey)throw new Error("no gaodejskey founded.");var c=new AMap.Map("container",{resizeEnable:!0,center:[120.159949,30.257373],zoom:13}),l=[];function s(e){var n=e.position,t=e.text,o=e.color,a=new AMap.Marker({icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",position:n,offset:new AMap.Pixel(-1,-1)});a.setMap(c);var r=document.createElement("span");r.className="marker",r.style.backgroundColor=o,r.innerHTML=t,a.setContent(r),l.push(a)}function u(){l.forEach(function(e,n){e.setMap(null),l[n]=null}),l=l.filter(Boolean)}window.markIt=function(){u();var e=document.getElementById("pois").value.split("\n"),n=[],t=e.map(function(e){return e.trim()}).filter(Boolean).map(function(e){var t,o=e.split(/,/).map(function(e){return e.trim()}).filter(Boolean),a=o.length,r=(t=o[a-1])&&"#"===t[0],i=r?o[a-3].trim():o[a-2].trim()-0,c=r?o[a-2].trim():o[a-1].trim()-0;return/NaN/.test(i)||/NaN/.test(c)?(console.log(e+" is invalid"),n.push(e),null):{text:o[0].trim(),position:[i,c],color:r?o[a-1]:"#1976d2"}}).filter(Boolean);if(0===t.length)return alert("no pois founded");t.forEach(function(e){return s(e)}),alert("done! marked "+t.length+" pois, "+(n.length?" invalids are: \n"+n.join(" \n"):""))};</script> </body> </html>