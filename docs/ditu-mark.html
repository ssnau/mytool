<!DOCTYPE html><html lang="en"> <head> <meta charset="UTF-8"> <meta other="__ver: 1662316668016"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta http-equiv="X-UA-Compatible" content="ie=edge"> <title>DITU MARK</title> <link href="//fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext" rel="stylesheet" type="text/css"> <link rel="stylesheet" href="mini-default.min.1469ec79.css"> <style>#container,body,html{height:100%;width:100%}.amap-icon img,.amap-marker-content img{width:25px;height:34px}.marker{position:absolute;top:-20px;right:-118px;color:#fff;padding:4px 10px;box-shadow:1px 1px 1px rgba(10,10,10,.2);white-space:nowrap;font-size:12px;background-color:#25a5f7;border-radius:3px}</style>  </head> <body> <div id="container"></div> <label for="modal-control" style="position:fixed;top:100px;right:100px;z-index:999;background-color:bisque;">显示配置</label> <input type="checkbox" id="modal-control" class="modal"> <div> <div class="card" style="max-width:780px;"> <label for="modal-control" class="modal-close"></label> <h3 class="section">配置</h3> <div class="row" id="navContainer"> <button class="small nav-btn" data-to="dCenter" id="nav-default"> 设置中心 </button> <button class="small nav-btn" data-to="dMark">标记POI</button> <button class="small nav-btn" data-to="dSearch">搜索POI</button> </div> <div id="dCenter" class="nav-content"> <legend>地图中心</legend> <input type="text" class="center-input" id="centerLng" placeholder="纬度" value="116.397428"> <input type="text" class="center-input" id="centerLat" placeholder="经度" value="39.90923 "> <button class="primary" onclick="setCenter()">确定</button> <legend>快捷方式</legend> <button onclick="setCenter(116.397029,39.91784)">北京</button> <button onclick="setCenter(121.499718, 31.239703)">上海</button> <button onclick="setCenter(120.164704, 30.25221)">杭州</button> <button onclick="setCenter(104.078657, 30.654899)">成都</button> <button onclick="setCenter(113.324553, 23.106414)">广州</button> <button onclick="setCenter(114.059812, 22.530799)">深圳</button> </div> <div id="dMark" class="nav-content"> <legend>要标记的POI列表</legend> <textarea placeholder="名字,经度,纬度" id="pois" style="width:96%"></textarea> <button class="primary" onclick="markIt()">确定标记</button> </div> <div id="dSearch" class="nav-content"> <legend>输入城市和POI名</legend> <input type="text" class="search-input" id="searchCity" value="杭州"> <input type="text" class="search-input" id="searchPOI" value="西湖国际中心"> <button class="primary" onclick="search()">搜索</button> <br> <pre id="searchResult"></pre> <p style="padding:6px 0;"> tip: 可以用 window.apiSearch(city, poiName) 来脚本化。 <img src="https://d2q5pvpg2i44d2.cloudfront.net/resources/20228/a28-4287-9b85-d9560b297385.png"> </p> </div> </div> </div>  <script>function e(e,n){var t=100,o=0,a=Date.now();return new Promise(function(n){!function r(){return o&&Date.now()-a>o?n(!1):e()?n(e()):void setTimeout(r,t)}()})}var n=new Proxy(new URLSearchParams(window.location.search),{get:function(e,n){return e.get(n)}});function t(e){document.write(" <script "+'type="text/javascript" src="'.concat(e,'"> </')+"script>")}function o(e){var n=document.createElement("script");n.setAttribute("src",e),document.head.appendChild(n)}function a(){Array.from(document.querySelectorAll(".nav-content")).forEach(function(e){return e.style.display="none"}),Array.from(document.querySelectorAll(".nav-btn")).forEach(function(e){return e.className=e.className.replace("inverse"," ").trim()})}function r(e){var n=e.dataset.to;n&&(a(),document.getElementById(n).style.display="block",e.className+=" inverse ")}function i(e,n){window.map.setCenter([e||document.getElementById("centerLng").value-0,n||document.getElementById("centerLat").value-0])}function c(){var e=new AMap.PlaceSearch({city:document.getElementById("searchCity").value}),n=document.getElementById("searchResult");n.innerHTML=" loading...",e.search(document.getElementById("searchPOI").value,function(e,t){console.log(t);var o=t.poiList.count?t.poiList.pois[0]:{};n.innerHTML="\n        ".concat(o.address,", ").concat(o.location.lng,", ").concat(o.location.lat," \n        ").trim()})}if(n.gaodejskey?(o("https://webapi.amap.com/maps?v=1.4.15&key=".concat(n.gaodejskey,"&plugin=AMap.PlaceSearch")),e(function(){return"undefined"!=typeof AMap}).then(function(){return o("https://cache.amap.com/lbs/static/PlaceSearchRender.js")})):setTimeout(function(){var e=location.origin+location.pathname;document.write("gaodejskey is empty, please define it on querystring by visiting ".concat(e,"?gaodejskey=xxxx"))}),a(),r(document.getElementById("nav-default")),document.getElementById("navContainer").addEventListener("click",function(e){r(e.target)}),window.setCenter=i,window.search=c,window.apiSearch=function(e,n){return new Promise(function(t){new AMap.PlaceSearch({city:e}).search(n,function(e,n){t(n.poiList.count?n.poiList.pois[0]:null)})})},!n.gaodejskey)throw new Error("no gaodejskey founded.");e(function(){return"undefined"!=typeof AMap&&AMap.Map}).then(function(){var e=new AMap.Map("container",{resizeEnable:!0,center:[120.159949,30.257373],zoom:13});window.map=e;var n=[];window.markIt=function(){n.forEach(function(e,t){e.setMap(null),n[t]=null}),n=n.filter(Boolean);var t=document.getElementById("pois").value.split("\n"),o=[],a=t.map(function(e){return e.trim()}).filter(Boolean).map(function(e){var n,t=e.split(/,/).map(function(e){return e.trim()}).filter(Boolean),a=t.length,r=(n=t[a-1])&&"#"===n[0],i=r?t[a-3].trim():t[a-2].trim()-0,c=r?t[a-2].trim():t[a-1].trim()-0;return/NaN/.test(i)||/NaN/.test(c)?(console.log(e+" is invalid"),o.push(e),null):{text:t[0].trim(),position:[i,c],color:r?t[a-1]:"#1976d2"}}).filter(Boolean);if(0===a.length)return alert("no pois founded");a.forEach(function(t){return function(t){var o=t.position,a=t.text,r=t.color,i=new AMap.Marker({icon:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",position:o,offset:new AMap.Pixel(-1,-1)});i.setMap(e);var c=document.createElement("span");c.className="marker",c.style.backgroundColor=r,c.innerHTML=a,i.setContent(c),n.push(i)}(t)}),alert("done! marked "+a.length+" pois, "+(o.length?" invalids are: \n"+o.join(" \n"):""))}});</script> </body> </html>